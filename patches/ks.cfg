#Generated by Kickstart Configurator
#platform=x86

#System language
lang en_US.UTF-8
#Language modules to install
langsupport de_CH.UTF-8 --default=en_US.UTF-8
#System keyboard
keyboard us
#System mouse
mouse

#System timezone
timezone --utc Europe/Zurich

#Root password
rootpw --disabled
#Initial user
user vagrant --fullname "Vagrant User" --iscrypted --password $1$agNRFFA9$iiBHuFfzfM09/IYj9CFbz/

#Shutdown and power off after installation
poweroff

#Use text mode install
text

#Install OS instead of upgrade
install

#Use CDROM installation media
#cdrom
url --url http://ch.archive.ubuntu.com/ubuntu

#System bootloader configuration
bootloader --location=mbr

#Clear the Master Boot Record
zerombr yes

#Partition clearing information
clearpart --all --initlabel --drives=/dev/sda
#Disk partitioning information
part / --fstype ext4 --size 1 --grow --asprimary
part swap --size 512 --asprimary

#System authorization infomation
auth  --useshadow  --enablemd5 

#Network information
network --bootproto=dhcp

#Firewall configuration
firewall --disabled 

#Do not configure the X Window System
skipx

%packages
@ ubuntu-server
openssh-server

%post
#!/bin/bash

#
# update
#
export DEBIAN_FRONTEND=noninteractive
apt-get -y install aptitude
aptitude update
aptitude -y upgrade


#
# sudo
#
aptitude -y install sudo
cp /etc/sudoers /etc/sudoers.bak
sed 's/^\%sudo\s/# &/' < /etc/sudoers.bak > /etc/sudoers
cat >> /etc/sudoers <<EOF

# Allow members of group sudo to execute any command without authentication
%sudo ALL=(ALL:ALL) NOPASSWD:ALL

EOF


#
# guest additions
#
aptitude -y --without-recommends install virtualbox-guest-dkms virtualbox-guest-utils
#adduser user vboxsf
cat >> /etc/modules <<EOF

#Virtualbox Guest Additions
vboxsf
vboxvideo

EOF


#
# disable persistent network devices
#
cat > /etc/udev/rules.d/75-persistent-net-generator.rules <<EOF
# This file overrules the generator for
# persistent network devices.

EOF

rm /etc/udev/rules.d/70-persistent-net.rules


#
# puppet
#

aptitude -y install ruby ruby-dev rubygems puppet openssh-client


#
# clean up
#

apt-get -y autoremove
apt-get -y clean


%end

